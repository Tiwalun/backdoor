{% extends "layout.html" %}
{% block body %}
    <h4>Add new device</h4>
    {% include 'add_device.html' %}
    <h4>Existing devices</h4>
    <table class="table table-striped table_devices">
        <thead>
        <tr>
            <td class="col-lg-1">ID</td>
            <td class="col-lg-3">Name</td>
            <td class="col-lg-5">Public-Key</td>
            <td class="col-lg-1">Creation Date</td>
            <td class="col-lg-1">Remove?</td>
        </tr>
        </thead>
        <tbody>
        {% for device in devices %}
            <tr>
                <td>{{ device.id }}</td>
                <td>
                    <form class="change_device_name" action="{{ url_for('change_device_name') }}" method=post>
                        <div class="input-group">
                            <input type="text" name="change_device_name" class="form-control" title="device owner" value="{{ device.name }}" readonly />
                            <span class="input-group-btn">
                                <button class="btn btn-default button_change_device_name" type="submit">
                                    <span class="glyphicon glyphicon-pencil" aria-hidden="true">
                                    </span>
                                </button>
                            </span>
                        </div>
                        <input type="text" name="change_device_id" class="invisible" title="" value="{{ device.id }}" />
                    </form>
                </td>
                <td>
                    <form class="change_device_pubkey" action="{{ url_for('change_device_pubkey') }}" method=post>
                        <div class="input-group">
                            <input type="text" name="change_device_pubkey" class="form-control" title="device owner" value="{{ device.pubkey }}" readonly />
                            <span class="input-group-btn">
                                <button class="btn btn-default button_change_device_pubkey" type="submit">
                                    <span class="glyphicon glyphicon-pencil" aria-hidden="true">
                                    </span>
                                </button>
                            </span>
                        </div>
                        <input type="text" name="change_device_id" class="invisible" title="" value="{{ device.id }}" />
                    </form>
                </td>
                <td>{{ device.creation_date }}</td>
                <td>
                    <form class="remove_form" action="{{ url_for('remove_device') }}" method=post>
                        <input type="submit" class="btn btn-default btn-danger" value="Remove" />
                        <input name="device_id" class="invisible" value="{{ device.id }}" title="device id"/>
                    </form>
                </td>
            </tr>
        {% else %}
            <tr>
                <td colspan="5" id="no_devices">Unbelievable. No devices here so far.</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    <script type="text/javascript">

        remove_init();

        init_edit_field('.button_change_device_name');
        init_edit_field('.button_change_device_pubkey');

    </script>
{% endblock %}
